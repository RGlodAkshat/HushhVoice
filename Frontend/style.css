/* =======================================================================
   HushhVoice — Cool Black UI (Electric Blue)
   Cleaned stylesheet matching your current index.html
   ======================================================================= */

/* =============== 0) Design Tokens =============== */
:root{
  /* Core surfaces & text */
  --bg:#05070a;            /* near-black */
  --bg-elev:#090c12;       /* raised */
  --panel:#0b0f15;
  --text:#e7eef9;
  --muted:#9aa7b5;
  --muted-2:#7d8a98;

  /* Accents */
  --accent:#00d1ff;        /* electric cyan */
  --accent-2:#14f195;      /* mint for rings */
  --accent-3:#5ee7ff;      /* light cyan */

  /* States */
  --danger:#ef4444; --danger-weak:rgba(239,68,68,.14);
  --success:#22c55e; --warning:#f59e0b;

  /* Borders & shadows */
  --border:#131a24; --border-2:#1a2431; --border-3:#223044;
  --shadow-1:0 10px 30px rgba(0,0,0,.40);
  --shadow-2:0 6px 18px rgba(0,0,0,.50);
  --glow-soft:0 10px 28px rgba(0,209,255,.22);
  --ring:0 0 0 2px rgba(0,209,255,.38);

  /* Radii, spacing, typography */
  --radius:14px; --radius-pill:999px;
  --s-1:4px; --s-2:8px; --s-3:12px; --s-4:16px; --s-6:24px; --s-8:32px; --s-10:40px;
  --fs-xs:12px; --fs-sm:13px; --fs-base:14px; --fs-md:15px; --fs-lg:17px;
  --fs-2xl:clamp(22px,3.2vw,40px);

  --maxw:880px; --container:min(100%, calc(var(--maxw) + 32px));
  --ease-std:cubic-bezier(.22,.61,.36,1);
  --t-fast:.12s; --t-med:.2s; --t-slow:.32s;
}

/* =============== 1) Base & a11y =============== */
*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ color-scheme:dark; }
body{
  margin:0; font:14px/1.6 system-ui,-apple-system,"Segoe UI",Roboto,Inter,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  color:var(--text);
  background:
    radial-gradient(1100px 520px at 72% -12%, rgba(0,209,255,.16) 0%, transparent 45%) fixed,
    radial-gradient(900px 520px at 8% 112%, rgba(20,241,149,.10) 0%, transparent 55%) fixed,
    var(--bg);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
::selection{ background:rgba(0,209,255,.28); color:#fff; }
kbd{
  padding:2px 6px; border-radius:6px; border:1px solid #17202c; background:#0b1119; color:#cfe2f5;
  font:600 12px ui-monospace,SFMono-Regular,Menlo,monospace;
}
@media (prefers-reduced-motion:reduce){ *{ animation:none!important; transition:none!important; } }

.visually-hidden{ position:absolute!important; inset:0 0 auto 0; width:1px; height:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap; }
.focusable:focus{ position:static; width:auto; height:auto; clip:auto; }

/* Scrollbars */
*::-webkit-scrollbar{ width:10px; height:10px; }
*::-webkit-scrollbar-thumb{ background:#1b2333; border-radius:var(--radius-pill); }
*::-webkit-scrollbar-track{ background:transparent; }

/* =============== 2) Cards & utility =============== */
.u-card{
  background:var(--bg-elev); border:1px solid var(--border); border-radius:var(--radius);
  box-shadow:var(--shadow-2);
  transition:transform var(--t-med) var(--ease-std), border-color var(--t-med), background var(--t-med);
}
.u-card:hover{ transform:translateY(-2px); border-color:var(--border-3); }
.u-focus-within:focus-within{ box-shadow:var(--ring); }

/* =============== 3) Buttons =============== */
.btn{
  appearance:none; border:1px solid var(--border-2);
  background:linear-gradient(180deg,#0b1320,#0a121e); color:var(--text);
  border-radius:12px; padding:8px 12px; cursor:pointer; position:relative; overflow:hidden;
  transition:border-color var(--t-med), background var(--t-med), transform var(--t-fast), box-shadow var(--t-med), color var(--t-med);
}
.btn:hover{ border-color:var(--border-3); background:#0d1626; }
.btn:active{ transform:translateY(1px); }
.btn:focus-visible{ outline:none; box-shadow:var(--ring); }
.btn.small{ padding:6px 10px; font-size:var(--fs-sm); }
.btn-ghost{ background:transparent; border-color:#1b2634; color:#d3deea; }
.btn.primary{
  background:linear-gradient(180deg, var(--accent), #0190d2);
  border:1px solid #03a8e0; color:#fff; box-shadow:var(--glow-soft);
}
.btn.primary:hover{ filter:brightness(1.06); }

/* Icon button + ripple */
.btn.icon{ width:44px; height:44px; display:grid; place-items:center; border-radius:12px; font-size:18px; }
.btn::after{
  content:""; position:absolute; top:var(--ripple-y,50%); left:var(--ripple-x,50%);
  width:8px; height:8px; transform:translate(-50%,-50%) scale(0);
  border-radius:50%; background:rgba(255,255,255,.18); opacity:0;
  transition:transform .5s var(--ease-std), opacity .7s var(--ease-std);
}
.btn.is-rippling::after{ transform:translate(-50%,-50%) scale(28); opacity:1; }

/* Mic/Stop */
.btn.icon.mic.recording{
  background:rgba(0,209,255,.14); border-color:var(--accent); color:#e7fbff;
  box-shadow:inset 0 0 0 2px rgba(0,209,255,.25), 0 0 0 2px rgba(0,209,255,.18);
}
.btn.icon.stop{ background:var(--danger-weak); border-color:var(--danger); color:#ffd6d6; }
.btn.icon.stop:hover{ background:rgba(239,68,68,.25); }

/* Optional gear */
.settings-btn{ width:44px; height:44px; border-radius:50%; display:grid; place-items:center; font-size:20px; }
.settings-btn:hover{
  border-color:var(--accent);
  background:linear-gradient(180deg,rgba(0,209,255,.15),rgba(0,209,255,.05));
  box-shadow:0 0 12px rgba(0,209,255,.35); transform:translateY(-1px);
}

/* =============== 4) Inputs / fields =============== */
.input,.field{
  min-height:44px; max-height:220px; resize:none;
  border:1px solid var(--border-2); border-radius:12px;
  background:var(--panel); color:var(--text); padding:12px; outline:none;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.02);
  transition:box-shadow var(--t-med), border-color var(--t-med), background var(--t-med);
}
.input:focus,.field:focus{ border-color:#1d2a3a; box-shadow:var(--ring), inset 0 1px 0 rgba(255,255,255,.02); }

/* =============== 5) App Shell =============== */
.app{ min-height:100dvh; display:grid; grid-template-rows:auto 1fr auto; }
.app-layout{ min-height:100dvh; display:grid; grid-template-columns:1fr; }

/* Sidebar */
.sidebar{
  position:fixed; inset:0 auto 0 0; width:300px; max-width:86vw;
  background:linear-gradient(180deg,rgba(5,7,10,.94),rgba(5,7,10,.92)), var(--bg-elev);
  border-right:1px solid var(--border); box-shadow:0 24px 70px rgba(0,0,0,.55);
  transform:translateX(-100%); transition:transform var(--t-slow) var(--ease-std); z-index:70;
  display:grid; grid-template-rows:auto 1fr auto; gap:0; padding:var(--s-3);
}
.sidebar.open{ transform:translateX(0); }
.app{ position:relative; z-index:10; }

@media (min-width:1100px){
  .app-layout{ grid-template-columns:300px 1fr; }
  .sidebar{ position:sticky; top:0; height:100dvh; transform:none!important; }
}
@media (min-width:900px) and (max-width:1099px){
  .app-layout{ grid-template-columns:270px 1fr; }
}

.sidebar-header{
  display:grid; grid-template-columns:64px 1fr; gap:var(--s-3); align-items:center;
  padding:var(--s-1) var(--s-1) var(--s-3); border-bottom:1px solid var(--border);
}
.profile-pic{
  width:64px; height:64px; border-radius:14px; object-fit:cover;
  border:1px solid #1b2431; box-shadow:0 6px 16px rgba(0,0,0,.45);
}
.profile-info{ display:grid; align-content:center; gap:2px; }
.profile-name{ margin:0; font-size:var(--fs-md); font-weight:800; }
.profile-subtitle{
  margin:2px 0 0; font-size:var(--fs-xs); font-weight:600; letter-spacing:.2px; color:var(--muted);
  display:inline-flex; align-items:center; gap:6px;
}
.profile-subtitle::before{
  content:""; width:6px; height:6px; border-radius:50%; background:var(--accent-2);
  box-shadow:0 0 0 4px rgba(20,241,149,.14);
}

.sidebar-content{
  display:grid; grid-auto-rows:max-content; gap:var(--s-3);
  padding:var(--s-3) var(--s-1) var(--s-4); overflow:auto;
}
.sidebar-footer{ border-top:1px solid var(--border); padding:var(--s-3) var(--s-1) 0; }
.sidebar-footer-row{ display:flex; align-items:center; gap:10px; padding-right:6px; }

/* =============== 6) Topbar =============== */
.topbar{
  position:sticky; top:0; z-index:50; display:grid; grid-template-columns:44px 1fr auto;
  align-items:center; gap:var(--s-3); padding:var(--s-3) var(--s-4);
  background:linear-gradient(180deg, rgba(5,7,10,.88), rgba(5,7,10,.64)), var(--bg-elev);
  border-bottom:1px solid var(--border); backdrop-filter:blur(8px) saturate(1.12);
}
#sidebar-toggle.btn.icon{ justify-self:start; }
.topbar .brand{ display:inline-flex; align-items:center; gap:var(--s-3); justify-self:center; max-width:min(84vw,980px); text-decoration:none; }
.topbar .logo{
  width:68px; height:68px; border-radius:14px; object-fit:cover;
  border:1px solid #1b2330; box-shadow:0 8px 26px rgba(0,209,255,.28), 0 3px 12px rgba(0,0,0,.38);
  transition:transform var(--t-med), box-shadow var(--t-med), filter var(--t-med);
}
.brand:hover .logo{ transform:translateY(-1px) scale(1.02); box-shadow:0 12px 36px rgba(0,209,255,.34), 0 6px 18px rgba(0,0,0,.45); }

.brand-text{ display:grid; line-height:1.06; gap:2px; }
.app-title{
  margin:0; font-weight:850; letter-spacing:.2px; font-size:var(--fs-2xl);
  background:linear-gradient(90deg,#c8f5ff 0%,#5ee7ff 35%,#00d1ff 65%,#14f195 100%);
  -webkit-background-clip:text; background-clip:text; color:transparent;
  text-shadow:0 10px 34px rgba(0,209,255,.18);
}
.app-sub{ margin:0; color:var(--muted); font-size:clamp(11px,1.3vw,13px); }
.auth{ justify-self:end; display:flex; align-items:center; gap:var(--s-3); }
.google-login>div{ transform:scale(.92); transform-origin:right center; }

@media (max-width:980px){ .topbar .logo{ width:56px; height:56px; border-radius:12px; } }
@media (max-width:620px){
  .topbar{ grid-template-columns:44px 1fr auto; padding:var(--s-2) var(--s-3); }
  .topbar .logo{ width:44px; height:44px; border-radius:10px; }
  .app-sub{ display:none; }
}

/* =============== 7) Chat =============== */
.chat{ display:grid; place-items:start center; padding:var(--s-4) 0 132px; }
.chat-box{
  list-style:none; margin:0; padding:0 var(--s-4); width:100%; max-width:var(--maxw);
  display:flex; flex-direction:column; gap:var(--s-3);
}
.msg{ display:grid; grid-template-columns:36px 1fr; gap:var(--s-3); }
.msg .avatar{
  width:36px; height:36px; border-radius:10px; display:grid; place-items:center;
  background:#0c1118; border:1px solid #1a2431; color:#a9b6c4; font-size:16px;
}
.msg .bubble{
  border:1px solid var(--border); background:var(--bg-elev); border-radius:var(--radius);
  padding:12px 14px; box-shadow:var(--shadow-1); position:relative; overflow:hidden;
  transition:border-color var(--t-med), background var(--t-med);
}
.msg.user .bubble{
  border:1px solid #1d2a3a;
  background:linear-gradient(180deg, rgba(0,209,255,.06), rgba(0,209,255,0)), var(--bg-elev);
}
.msg.bot .bubble{
  border:1px solid #192536;
  background:linear-gradient(180deg, rgba(20,241,149,.05), rgba(20,241,149,0)), var(--bg-elev);
}
.msg .content{ white-space:pre-wrap; overflow-wrap:anywhere; }
.msg.bot .content a{ color:#8fd6ff; text-decoration:none; border-bottom:1px dashed rgba(143,214,255,.4); }
.msg.bot .content a:hover{ border-bottom-color:rgba(143,214,255,.8); }
.msg .bubble::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:radial-gradient(600px 200px at 0% -20%, rgba(0,209,255,.10), transparent 55%); opacity:.6;
}

/* Typing dots */
.msg.bot.typing .bubble{ display:inline-flex; align-items:center; }
.dots{ display:inline-flex; gap:6px; }
.dots i{ width:6px; height:6px; border-radius:50%; background:#a7b0be; opacity:.6; transform:translateY(0); animation:dot 1.2s infinite ease-in-out; }
.dots i:nth-child(2){ animation-delay:.15s; } .dots i:nth-child(3){ animation-delay:.3s; }
@keyframes dot{ 0%,80%,100%{transform:translateY(0);opacity:.6;} 40%{transform:translateY(-4px);opacity:1;} }

/* =============== 8) Composer =============== */
.composer{
  position:fixed; left:0; right:0; bottom:0; z-index:40; display:grid; place-items:center;
  background:linear-gradient(180deg, rgba(5,7,10,0), rgba(5,7,10,.94) 28%);
  border-top:1px solid #0e141c; padding:18px 12px 14px;
}
.composer-inner{ width:var(--container); display:grid; gap:var(--s-3); }
.attachment-bar{ border:1px dashed var(--border-2); border-radius:12px; padding:8px 10px; color:var(--muted); background:#0c121a; display:none; }
.input-row{ display:grid; align-items:end; gap:var(--s-3); grid-template-columns:auto 1fr auto; }
.btn.primary.send{ height:44px; border-radius:12px; display:grid; place-items:center; padding:0 16px; font-weight:700; letter-spacing:.2px; }

/* Tooltray */
.tooltray{
  display:inline-flex; align-items:center; gap:6px; padding:4px; border-radius:12px;
  background:linear-gradient(180deg, rgba(11,17,25,.65), rgba(9,14,22,.55));
  border:1px solid var(--border-2); box-shadow:inset 0 1px 0 rgba(255,255,255,.02);
}
.tooltray .btn.icon{ width:38px; height:38px; border-radius:10px; border-color:transparent; background:transparent; color:var(--muted); }
.tooltray .btn.icon:hover{ background:rgba(0,209,255,.10); color:#e5fbff; }
.tooltray .btn.icon.mic.recording{ background:rgba(0,209,255,.18); border-color:transparent; color:#e9fffb; box-shadow:inset 0 0 0 2px rgba(0,209,255,.22); }
.tooltray .btn.icon.stop{ display:none; }
body.is-speaking .tooltray .btn.icon.stop{ display:grid; }

.hints{ display:flex; align-items:center; justify-content:center; color:var(--muted); font-size:var(--fs-xs); }

@media (max-width:720px){ .btn.primary.send{ padding:0 10px; } }
@media (max-width:420px){
  .input-row{ grid-template-columns:auto 1fr auto; gap:var(--s-2); }
  .btn.icon, .btn.primary.send{ height:42px; }
  .input{ min-height:42px; }
}

/* Attachment chip */
.chip{
  display:inline-flex; align-items:center; gap:8px; padding:6px 8px 6px 6px;
  border:1px solid var(--border-2); background:linear-gradient(180deg,#0c121a,#0a1119);
  border-radius:12px; box-shadow:var(--shadow-2);
}
.chip-thumb{ width:44px; height:44px; object-fit:cover; border-radius:10px; border:1px solid var(--border); }
.chip .btn.remove-attach{ border-color:transparent; background:transparent; color:var(--muted); width:32px; height:32px; border-radius:8px; padding:0; }
.chip .btn.remove-attach:hover{ background:rgba(239,68,68,.16); color:#ffd6d6; }

/* =============== 9) Toasts & Modals =============== */
.toasts{
  position:fixed; top:16px; right:16px; z-index:60; display:grid; gap:10px; width:min(360px,92vw);
}
.toast{
  border:1px solid #1a2636; background:linear-gradient(180deg,rgba(14,19,28,.94),rgba(10,15,24,.94));
  color:#cfdae8; border-radius:12px; padding:10px 12px; box-shadow:var(--shadow-2);
  transform:translateY(-4px); opacity:0; animation:toastIn .28s var(--ease-std) forwards;
}
@keyframes toastIn{ to{ transform:translateY(0); opacity:1; } }

.modal{
  border:1px solid #1a2636; border-radius:16px;
  background:radial-gradient(800px 300px at 50% -10%, rgba(0,209,255,.14), transparent 45%), #0b1119;
  color:var(--text); padding:18px 16px; width:min(520px,96vw); box-shadow:var(--shadow-1);
}
.modal::backdrop{ background:rgba(0,0,0,.55); }
.modal h3{ margin:0 0 6px; font-size:var(--fs-md); }
.modal p{ margin:0 0 12px; color:var(--muted-2); }
.modal-actions{ display:flex; justify-content:flex-end; gap:8px; }

/* =============== 10) Settings Modal (Consent/Bio/Memory) =============== */
.settings-modal{ max-width:min(720px,96vw); padding:0; }
.settings-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:16px 16px 10px; border-bottom:1px solid var(--border);
  background:linear-gradient(180deg, rgba(0,209,255,.10), rgba(0,209,255,0));
  border-radius:16px 16px 0 0;
}
.settings-title-wrap{ display:flex; align-items:center; gap:12px; }
.settings-icon{ width:36px; height:36px; display:grid; place-items:center; border:1px solid var(--border-2); border-radius:10px; background:#0c121a; }
.settings-title{ margin:0; font-size:var(--fs-lg); font-weight:800; letter-spacing:.2px; }
.settings-sub{ margin:2px 0 0; color:var(--muted-2); font-size:var(--fs-xs); }
.settings-panel{ padding:14px 16px 16px; display:grid; gap:16px; }
.pane{ display:grid; gap:12px; }
.pane-head{ display:grid; gap:4px; }
.pane-divider{ height:1px; border:0; background:linear-gradient(90deg,transparent,var(--border),transparent); margin:4px 0; }
.settings-actions{ border-top:1px solid var(--border); padding:10px 16px 14px; }

/* Consent */
.consent-grid{ display:grid; gap:10px; grid-template-columns:1fr; }
@media (min-width:560px){ .consent-grid{ grid-template-columns:1fr 1fr; } }

.consent-card{
  --hover-bg:linear-gradient(180deg, rgba(0,209,255,.08), rgba(0,209,255,0));
  display:grid; grid-template-columns:1fr auto; align-items:center; gap:12px;
  padding:12px; border:1px solid var(--border); border-radius:12px; background:var(--bg-elev);
  cursor:pointer; user-select:none;
  transition:border-color var(--t-med), transform var(--t-fast), background var(--t-med);
}
.consent-card:hover{ border-color:var(--border-3); background:var(--hover-bg), var(--bg-elev); transform:translateY(-1px); }
.consent-meta{ display:flex; align-items:center; gap:10px; }
.consent-icon{ width:36px; height:36px; border-radius:10px; display:grid; place-items:center; background:#0c121a; border:1px solid var(--border-2); box-shadow:inset 0 1px 0 rgba(255,255,255,.02); }
.consent-title{ font-weight:800; letter-spacing:.2px; }
.consent-desc{ font-size:var(--fs-xs); color:var(--muted-2); }

/* Switch */
.switch-input{ position:absolute; opacity:0; pointer-events:none; }
.switch{
  --w:50px; --h:28px; --p:3px; --dot:calc(var(--h) - var(--p)*2);
  position:relative; width:var(--w); height:var(--h); border-radius:999px;
  border:1px solid var(--border-2); background:linear-gradient(180deg,#0b1320,#0a121e);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.02);
  transition:background var(--t-med) var(--ease-std), border-color var(--t-med), box-shadow var(--t-med);
}
.switch::after{
  content:""; position:absolute; top:var(--p); left:var(--p);
  width:var(--dot); height:var(--dot); border-radius:999px; background:#d4deea; box-shadow:0 2px 8px rgba(0,0,0,.35);
  transition:left var(--t-med) var(--ease-std), background var(--t-med), transform var(--t-med);
}
.switch-input:checked + .switch{
  background:linear-gradient(180deg, rgba(0,209,255,.42), rgba(1,144,210,.62));
  border-color:#03a8e0; box-shadow:var(--glow-soft);
}
.switch-input:checked + .switch::after{ left:calc(var(--w) - var(--dot) - var(--p)); background:#fff; transform:scale(1.02); }
.consent-card:focus-within{ box-shadow:var(--ring); }

/* Bio / Memory */
.section-actions{ display:flex; align-items:center; gap:8px; justify-content:flex-end; }
.char-hint{ color:var(--muted-2); font-size:var(--fs-xs); }
.char-hint.warn{ color:var(--warning); } .char-hint.max{ color:var(--danger); }

.memory-form{ display:grid; grid-template-columns:1fr auto; gap:var(--s-2); align-items:center; }
.memory-form .field{ border:1px solid var(--border-2); border-radius:12px; background:linear-gradient(180deg,var(--panel),#0a1119); color:var(--text); padding:12px 14px; caret-color:var(--accent-2); }
.memory-form .field::placeholder{ color:var(--muted-2); opacity:.9; font-style:italic; }

.memory-log-wrap{
  position:relative; border:1px solid var(--border); border-radius:12px;
  background:radial-gradient(100% 60% at 0% 0%, rgba(0,209,255,.10), transparent 60%),
             linear-gradient(180deg, rgba(20,241,149,.035), rgba(20,241,149,0)), var(--bg-elev);
  padding:10px; max-height:280px; overflow:auto; overscroll-behavior:contain; scroll-behavior:smooth; box-shadow:var(--shadow-2);
}
.memory-log-wrap::before,.memory-log-wrap::after{ content:""; position:sticky; left:0; right:0; height:16px; pointer-events:none; z-index:1; }
.memory-log-wrap::before{ top:0; background:linear-gradient(180deg, rgba(5,7,10,.7), rgba(5,7,10,0)); }
.memory-log-wrap::after{ bottom:0; background:linear-gradient(0deg, rgba(5,7,10,.7), rgba(5,7,10,0)); }
.memory-log{ list-style:none; margin:0; padding:0; display:grid; gap:8px; }
.memory-log:empty::after{ content:"No memories yet. Add your first one above."; display:block; text-align:center; color:var(--muted); padding:18px 8px; font-size:var(--fs-sm); }
.memory-item{
  position:relative; border:1px solid var(--border); background:#0b1119; border-radius:10px; padding:8px 10px 8px 14px; color:var(--text); font-size:13px;
  transition:border-color var(--t-med), background var(--t-med), transform var(--t-fast);
}
.memory-item::before{
  content:""; position:absolute; left:0; top:0; bottom:0; width:3px; border-radius:10px 0 0 10px;
  background:linear-gradient(180deg, var(--accent-3), var(--accent)); opacity:.6; box-shadow:0 0 16px rgba(0,209,255,.24);
}
.memory-item:hover{ border-color:var(--border-3); background:#0d141e; transform:translateY(-1px); }
.memory-row{ display:grid; grid-template-columns:1fr auto; align-items:baseline; gap:10px; }
.memory-text{ line-height:1.5; overflow-wrap:anywhere; }
.memory-time{ color:var(--muted-2); font-size:12px; white-space:nowrap; }
.memory-actions{ display:flex; justify-content:flex-end; gap:var(--s-2); }

/* =============== 11) Background Art =============== */
.bg-anim{
  position:fixed; inset:0; z-index:0; pointer-events:none;
  background:
    radial-gradient(1200px 600px at 70% -10%, rgba(0,209,255,.14) 0%, transparent 42%) fixed,
    radial-gradient(900px 500px at 10% 110%, rgba(20,241,149,.16) 0%, transparent 48%) fixed,
    var(--bg);
  animation:hueFloat 24s ease-in-out infinite alternate;
}
.bg-anim::before{
  content:""; position:absolute; inset:-15%;
  background:
    radial-gradient(42% 42% at 60% 40%, rgba(0,209,255,.28), transparent 60%),
    radial-gradient(36% 36% at 30% 65%, rgba(20,241,149,.18), transparent 62%),
    conic-gradient(from 0deg at 50% 50%, rgba(0,209,255,.18), rgba(0,209,255,.06), rgba(20,241,149,.12), rgba(0,209,255,.18));
  filter:blur(100px) saturate(1.05); opacity:.16; mix-blend-mode:screen; animation:nebulaSpin 60s linear infinite;
}
@keyframes hueFloat{ 0%{ filter:hue-rotate(0deg) saturate(1); transform:translate3d(0,0,0);} 100%{ filter:hue-rotate(-10deg) saturate(1.1); transform:translate3d(0,-4px,0);} }
@keyframes nebulaSpin{ from{ transform:rotate(0) scale(1);} to{ transform:rotate(360deg) scale(1);} }

.bg-logo{
  position:fixed; left:50%; top:48%; transform:translate(-50%,-50%) scale(1);
  width:min(50vw,640px); max-width:92%; opacity:.12; z-index:1; pointer-events:none;
  filter:drop-shadow(0 40px 120px rgba(0,209,255,.32)) drop-shadow(0 8px 40px rgba(0,209,255,.26)) saturate(1.06) blur(.2px);
  mix-blend-mode:screen; animation:logoGlow 6.5s ease-in-out infinite;
}
@keyframes logoGlow{
  0%{ opacity:.11; filter:drop-shadow(0 40px 120px rgba(0,209,255,.28)) drop-shadow(0 8px 40px rgba(0,209,255,.22)); }
  50%{ opacity:.18; filter:drop-shadow(0 50px 150px rgba(0,209,255,.40)) drop-shadow(0 10px 60px rgba(0,209,255,.32)); }
  100%{ opacity:.12; filter:drop-shadow(0 40px 120px rgba(0,209,255,.32)) drop-shadow(0 8px 40px rgba(0,209,255,.26)); }
}

/* Starscape */
:root{ --star-1:var(--accent-3,#5ee7ff); --star-2:#c7eaff; --meteor:var(--accent-3,#5ee7ff); --space:rgba(0,0,0,0); }
.bg-stars{ position:fixed; inset:0; z-index:0; pointer-events:none;
  background:radial-gradient(1200px 600px at 70% -10%, rgba(0,209,255,.10), transparent 45%) fixed,
             radial-gradient(900px 500px at 10% 110%, rgba(20,241,149,.10), transparent 50%) fixed;
}
.bg-stars .stars{
  position:absolute; top:0; left:0; width:1px; height:1px; background:var(--star-1);
  box-shadow:2vw 5vh 2px var(--star-1), 10vw 8vh 2px var(--star-1), 15vw 15vh 1px var(--star-1),
             22vw 22vh 1px var(--star-1), 28vw 12vh 2px var(--star-1), 32vw 32vh 1px var(--star-1),
             38vw 18vh 2px var(--star-1), 42vw 35vh 1px var(--star-1), 48vw 25vh 2px var(--star-1),
             53vw 42vh 1px var(--star-1), 58vw 15vh 2px var(--star-1), 63vw 38vh 1px var(--star-1);
  animation:twinkleSlow 16s linear infinite; filter:drop-shadow(0 0 2px rgba(94,231,255,.45));
}
.bg-stars .stars::after{
  content:""; position:absolute; width:1px; height:1px; background:var(--star-2);
  box-shadow:8vw 12vh 2px var(--star-2), 16vw 18vh 1px var(--star-2), 24vw 25vh 2px var(--star-2),
             33vw 15vh 1px var(--star-2), 41vw 28vh 2px var(--star-2), 49vw 35vh 1px var(--star-2);
  animation:twinkleSlowAlt 22s linear infinite reverse; filter:drop-shadow(0 0 2px rgba(199,235,255,.35));
}
@keyframes twinkleSlow{ 0%,100%{opacity:.9} 50%{opacity:.45} }
@keyframes twinkleSlowAlt{ 0%,100%{opacity:.85} 50%{opacity:.40} }

.bg-stars .shooting-star{
  position:absolute; left:-160px; width:140px; height:2px;
  background:linear-gradient(90deg,var(--meteor),var(--space));
  transform:rotate(22deg); opacity:0; filter:drop-shadow(0 0 6px rgba(94,231,255,.65));
  animation:shootSlow 7.5s ease-in infinite;
}
.bg-stars .shooting-star:nth-of-type(1){ top:22%; animation-delay:0s; }
.bg-stars .shooting-star:nth-of-type(2){ top:38%; animation-delay:2.6s; }
.bg-stars .shooting-star:nth-of-type(3){ top:54%; animation-delay:5.2s; }
@keyframes shootSlow{
  0%{ transform:translateX(0) translateY(0) rotate(22deg); opacity:0; }
  3%{ opacity:1; } 85%{ opacity:.9; }
  100%{ transform:translateX(120vw) translateY(50vh) rotate(22deg); opacity:0; }
}

/* =========================================================
   CHATS PANEL — structure styled only (SVG icons from HTML)
   ========================================================= */

/* Container */
#chats-panel {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 0.75rem;
  max-width: 100%;
  width: 100%;
  overflow-x: hidden;
  border-radius: 0.875rem;
}

/* Header */
#chats-panel .chats-head { display: grid; gap: 0.625rem; }
#chats-panel .chats-new {
  width: 100%;
  text-align: center;
  padding: 0.625rem 0.75rem;
  font-weight: 700;
  border-radius: 0.75rem;
}
#chats-panel .chats-search { width: 100%; }
#chats-panel .chats-search-input {
  width: 100%;
  border-radius: 0.75rem;
  padding: 0.625rem 0.75rem;
  background: linear-gradient(180deg, var(--panel), #0a1119);
}

/* List wrapper */
#chats-panel .chats-list-wrap{
  position: relative;
  flex: 1 1 auto;
  min-height: 11.25rem;
  border: 0.0625rem solid var(--border);
  border-radius: 0.75rem;
  background: var(--bg-elev);
  overflow: auto;
  padding: 0.5rem;
  box-shadow: var(--shadow-2);
  max-width: 100%;
}
#chats-panel .chats-list-wrap::-webkit-scrollbar{ width: .5rem; }
#chats-panel .chats-list-wrap::-webkit-scrollbar-thumb{ background:#1b2333; border-radius: var(--radius-pill); }

#chats-panel .threads-empty{
  text-align: center;
  color: var(--muted);
  padding: 1rem .375rem;
  font-size: .875rem;
}
#chats-panel .threads-list{
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: .5rem;
}

/* Row card */
#chats-panel .thread{
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: auto auto; /* title then actions */
  gap: .5rem;
  position: relative;
  border: .0625rem solid var(--border);
  border-radius: .75rem;
  background: #0a0f16;
  transition: border-color var(--t-med), background var(--t-med), transform var(--t-fast);
  max-width: 100%;
}
#chats-panel .thread:hover{
  border-color: var(--border-3);
  background: #0c131c;
  transform: translateY(-.05rem);
}

/* Accent bar + active */
#chats-panel .thread::before{
  content:"";
  position:absolute; inset:0 auto 0 0;
  width:.18rem; border-radius:.75rem 0 0 .75rem;
  background:linear-gradient(180deg,var(--accent-3),var(--accent));
  opacity:.45;
}
#chats-panel .thread[data-selected="true"]{
  border-color:#03a8e0;
  background:linear-gradient(180deg,rgba(0,209,255,.10),rgba(0,209,255,0)),#0a0f16;
  box-shadow: inset 0 0 0 .0625rem rgba(3,168,224,.35);
}

/* Title row */
#chats-panel .thread-main{
  width: 100%;
  padding: .6rem .75rem 0 .75rem;
  border: 0;
  background: transparent;
  cursor: pointer;
  color: var(--text);
  border-radius: .75rem;
}
#chats-panel .thread-top{ display:block; min-width:0; }
#chats-panel .thread-title{
  display:block;
  font-weight:700;
  letter-spacing:.01em;
  font-size:.9rem;
  max-width:100%;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

/* Hide time + snippet for title-only rows (uncomment to show) */
#chats-panel .thread-time,
#chats-panel .thread-snippet { display: none !important; }
/* To show them, delete the 2 rules above and add:
#chats-panel .thread-top { display:flex; align-items:baseline; justify-content:space-between; gap:.5rem; }
#chats-panel .thread-time { color:var(--muted-2); font-size:.75rem; white-space:nowrap; flex:0 0 auto; }
#chats-panel .thread-snippet { margin:.25rem 0 0; color:var(--muted); font-size:.875rem; overflow:hidden; text-overflow:ellipsis; }
*/

/* Actions row (always visible, wraps if narrow) */
#chats-panel .thread-actions{
  display: flex;
  flex-wrap: wrap;
  gap: .4rem;
  align-items: center;
  padding: 0 .75rem .65rem .75rem;
  max-width: 100%;
  overflow-x: hidden;
}

/* Icon buttons (SVG from HTML; do NOT hide SVG) */
#chats-panel .thread .btn.icon{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  padding: 0;
  border-radius: .55rem;
  border: .0625rem solid transparent;
  background: transparent;
  color: var(--muted);
  transition: background var(--t-med), border-color var(--t-med), transform var(--t-fast);
}
#chats-panel .thread .btn.icon svg{
  width: 1.15rem;
  height: 1.15rem;
  pointer-events: none;
}

/* Hover tints */
#chats-panel .thread-pin:hover{
  color:#eaf8ff;
  background:rgba(0,209,255,.16);
  border-color:#1e2c3e;
  transform:translateY(-.04rem);
}
#chats-panel .thread-rename:hover{
  color:#dbfff2;
  background:rgba(20,241,149,.16);
  border-color:#1e2f28;
  transform:translateY(-.04rem);
}
#chats-panel .thread-delete:hover{
  color:#ffd7d7;
  background:rgba(239,68,68,.16);
  border-color:var(--danger);
  transform:translateY(-.04rem);
}

/* Safety: prevent sideways scroll */
#chats-panel,
#chats-panel .threads-list,
#chats-panel .thread,
#chats-panel .thread-main,
#chats-panel .thread-actions{
  max-width:100%;
  overflow-x:hidden;
}

/* Narrow sidebars */
@media (max-width:56.25rem){
  #chats-panel .thread-title{ font-size:.85rem; }
  #chats-panel .thread .btn.icon{
    width: 1.8rem;
    height: 1.8rem;
  }
  #chats-panel .thread .btn.icon svg{
    width: 1rem;
    height: 1rem;
  }
  #chats-panel .thread-actions{ gap:.32rem; }
}

/* ================================
   Chats panel: left-aligned + polish
   (place this AFTER your existing chats CSS)
   ================================ */

/* 1) Left-align everything inside the panel */
#chats-panel,
#chats-panel .chats-head,
#chats-panel .threads-empty,
#chats-panel .thread-main,
#chats-panel .thread-actions { text-align: left; }

/* make grid items stretch to full width (prevents centering feel) */
#chats-panel .threads-list { justify-items: stretch; }

/* 2) New Chat button: left-aligned label (not centered) */
#chats-panel .chats-new {
  display: flex;
  align-items: center;
  justify-content: flex-start;   /* left */
  gap: .5rem;
  font-weight: 700;
}

/* 3) Tighten the row spacing & make actions hug the left cleanly */
#chats-panel .thread {
  padding: 0; /* we control padding on inner parts */
}
#chats-panel .thread-main {
  padding: .55rem .75rem .15rem .75rem; /* a hair tighter */
}
#chats-panel .thread-actions {
  justify-content: flex-start;   /* left, not centered or right */
  padding: .15rem .75rem .6rem .75rem;
  gap: .35rem;
}

/* 4) Ensure icons don't look floaty; consistent sizing */
#chats-panel .thread .btn.icon {
  width: 1.9rem;
  height: 1.9rem;
  border-radius: .5rem;
}
#chats-panel .thread .btn.icon svg {
  width: 1rem;
  height: 1rem;
}

/* 5) Empty state: left align, subtle tone */
#chats-panel .threads-empty {
  text-align: left;
  padding: .75rem;
  border: 1px dashed var(--border-2);
  border-radius: .625rem;
  background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
}

/* 6) Title row polish: clear baseline and truncation */
#chats-panel .thread-top { display: block; min-width: 0; }
#chats-panel .thread-title {
  display: block;
  font-weight: 700;
  letter-spacing: .01em;
  font-size: .92rem;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* (still hiding time/snippet; remove if you want them visible) */
#chats-panel .thread-time,
#chats-panel .thread-snippet { display: none !important; }

/* 7) Hover/active subtlety so rows feel grounded, not floaty */
#chats-panel .thread:hover {
  border-color: var(--border-3);
  background: #0c131c;
  transform: translateY(-.025rem); /* smaller nudge (less float) */
}
#chats-panel .thread[data-selected="true"] {
  border-color:#03a8e0;
  background: linear-gradient(180deg, rgba(0,209,255,.08), rgba(0,209,255,0)), #0a0f16;
  box-shadow: inset 0 0 0 .06rem rgba(3,168,224,.30);
}

/* 8) Narrow sidebars: keep things crisp */
@media (max-width:56.25rem){
  #chats-panel .thread-title{ font-size:.85rem; }
  #chats-panel .thread .btn.icon{
    width: 1.7rem;
    height: 1.7rem;
  }
  #chats-panel .thread .btn.icon svg{
    width: .95rem;
    height: .95rem;
  }
  #chats-panel .thread-actions{ gap:.28rem; }
}
/* --- Chats panel: left alignment & improved action buttons --- */

/* Left align everything in the panel */
#chats-panel,
#chats-panel .threads-empty,
#chats-panel .thread-main,
#chats-panel .thread-actions { text-align: left; }

/* Make list items occupy full width */
#chats-panel .threads-list { justify-items: stretch; }

/* Row spacing/polish */
#chats-panel .thread { padding: 0; }
#chats-panel .thread-main { padding: .55rem .75rem .15rem .75rem; }
#chats-panel .thread-actions {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: flex-start;
  gap: .45rem;
  padding: .2rem .75rem .6rem .75rem;
}

/* Pill buttons with labels (use SVG from HTML, no ::before icons) */
#chats-panel .btn.action{
  display: inline-flex;
  align-items: center;
  gap: .45rem;
  padding: .38rem .6rem;
  border-radius: .6rem;
  border: 1px solid var(--border-2);
  background: linear-gradient(180deg, #0b1320, #0a121e);
  color: var(--text);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.02);
  transition: background var(--t-med), border-color var(--t-med), transform var(--t-fast), box-shadow var(--t-med);
}
#chats-panel .btn.action:hover{
  background: #0e1626;
  border-color: var(--border-3);
  transform: translateY(-.025rem);
}
#chats-panel .btn.action:focus-visible{
  outline: none;
  box-shadow: var(--ring);
}
#chats-panel .btn.action:active{
  transform: translateY(0);
}

/* SVG sizing */
#chats-panel .btn.action svg{
  width: 1rem;
  height: 1rem;
  opacity: .95;
}

/* Color accents per action */
#chats-panel .btn.action.pin:hover{
  background: linear-gradient(180deg, rgba(0,209,255,.16), rgba(0,209,255,.08));
  border-color: #1e2c3e;
}
#chats-panel .btn.action.rename:hover{
  background: linear-gradient(180deg, rgba(20,241,149,.16), rgba(20,241,149,.08));
  border-color: #1d2f28;
}
#chats-panel .btn.action.danger{
  border-color: rgba(239,68,68,.35);
  color: #ffd7d7;
  background: linear-gradient(180deg, rgba(239,68,68,.10), rgba(239,68,68,.06));
}
#chats-panel .btn.action.danger:hover{
  background: linear-gradient(180deg, rgba(239,68,68,.16), rgba(239,68,68,.10));
  border-color: var(--danger);
}

/* Title-only rows (hide time/snippet); delete to show them */
#chats-panel .thread-time,
#chats-panel .thread-snippet { display: none !important; }

/* Slightly calmer hover for row */
#chats-panel .thread:hover{
  border-color: var(--border-3);
  background: #0c131c;
  transform: translateY(-.02rem);
}

/* Active row */
#chats-panel .thread[data-selected="true"]{
  border-color:#03a8e0;
  background: linear-gradient(180deg, rgba(0,209,255,.08), rgba(0,209,255,0)), #0a0f16;
  box-shadow: inset 0 0 0 .06rem rgba(3,168,224,.30);
}

/* Responsive: collapse labels on narrow sidebars */
@media (max-width: 40rem){
  #chats-panel .btn.action { padding: .35rem; width: 1.9rem; height: 1.9rem; justify-content: center; }
  #chats-panel .btn.action .action-label { display: none; }
  #chats-panel .btn.action svg { width: 1rem; height: 1rem; }
  #chats-panel .thread-actions { gap: .32rem; }
}

/* Ensure dialog displays when using [open] fallback */
dialog[open] {
  display: block;
}

/* Keep our settings modal visually above regular content if no native backdrop */
#dialog-backdrop-shim + .settings-modal,
.settings-modal[open] {
  z-index: 9999;
}

/* =========================
   Auth actions (topbar)
   ========================= */
   .auth-actions{
    display:flex;
    align-items:center;
    gap: var(--s-2);
    margin-left: var(--s-3);
  }
  
  @media (max-width: 720px){
    .auth-actions{
      gap: var(--s-1);
      flex-wrap: wrap;
      justify-content: flex-end;
    }
  }
  
  /* Buttons inherit .btn styles; we add light brand accents per tool */
  #btn-connect-google{
    /* Neutral dark button that matches your UI */
    background: linear-gradient(180deg,#0b1320,#0a121e);
    border:1px solid var(--border-2);
    color: var(--text);
  }
  #btn-connect-google:hover{ background:#0e1626; border-color: var(--border-3); }
  
  /* Compact buttons sit well in the topbar */
  .auth-actions .btn.small{
    width: 100px;
    height: auto;
    padding: 6px 12px;
    border-radius: 10px;
    font-weight: 700;
    letter-spacing: .2px;
  }
  
  /* Connected state (apply via JS when token exists for that scope) */
  .btn.is-connected{
    position: relative;
    border-color: var(--accent-2) !important;
    box-shadow: 0 0 0 2px rgba(20,241,149,.22), inset 0 1px 0 rgba(255,255,255,.03);
  }
  .btn.is-connected::after{
    content: "✓ Connected";
    position: absolute;
    inset: auto 8px 8px auto;
    font-size: 11px;
    font-weight: 800;
    color: #d9ffe8;
    background: linear-gradient(180deg, rgba(20,241,149,.20), rgba(20,241,149,.10));
    border: 1px solid rgba(20,241,149,.45);
    padding: 2px 6px;
    border-radius: 6px;
    pointer-events: none;
  }
  
  /* Disabled state helper (if you want to lock the button after connect) */
  .btn.is-disabled{
    opacity: .55;
    cursor: not-allowed;
    filter: grayscale(.2);
  }
  
  /* When user is signed in and you replace the Google button with email text */
  .signed-in-email{
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border: 1px solid #1b2431;
    border-radius: 10px;
    background: linear-gradient(180deg,#0b1119,#0a1118);
    color: var(--text);
    font-weight: 700;
    font-size: var(--fs-sm);
    box-shadow: var(--shadow-2);
    white-space: nowrap;
  }
  .signed-in-email::before{
    content: "";
    width: 8px; height: 8px; border-radius: 50%;
    background: var(--accent-2);
    box-shadow: 0 0 0 4px rgba(20,241,149,.14);
  }
  
  /* Keep the Google mount from collapsing before render */
  #google-btn{
    min-width: 200px;
    min-height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Micro polish so the group aligns nicely with topbar content */
  .topbar .auth-actions .btn{ transform: translateZ(0); } /* GPU hint */


  /* Cluster: keeps Google button + connect buttons inline */
.auth-cluster {
  display: flex;
  align-items: center;
  gap: var(--s-2);
  margin-left: var(--s-3);
}

.auth-actions {
  display: flex;
  align-items: center;
  gap: var(--s-1);
}

/* Base style for small connect buttons */
.btn.connect.small {
  padding: 4px 10px;
  border-radius: var(--radius-pill);
  font-size: var(--fs-xs);
  font-weight: 600;
  background: linear-gradient(180deg,#0b1320,#0a121e);
  border: 1px solid var(--border-2);
  color: var(--muted);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
  transition: all var(--t-med) var(--ease-std);
}

.btn.connect.small:hover {
  background: #0e1626;
  border-color: var(--border-3);
  color: var(--text);
}

/* Highlight when connected */
.btn.connect.is-connected {
  color: #d9ffe8;
  border-color: var(--accent-2);
  box-shadow: 0 0 0 2px rgba(20,241,149,.25);
}
.btn.connect.is-connected::after {
  content: "✓";
  margin-left: 4px;
  font-weight: 700;
  color: var(--accent-2);
}

/* Keep things tidy on small screens */
@media (max-width:720px) {
  .auth-cluster {
    flex-wrap: wrap;
    gap: var(--s-1);
    justify-content: flex-end;
  }
  .btn.connect.small {
    padding: 4px 8px;
  }
}
